[2026-01-05 17:01:34,174][__main__][INFO] - Training Config: 
seed: 42
debug: false
data:
  paths:
    ptbxl: /workspace/data/ptbxl/ptb-xl-a-large-publicly-available-electrocardiography-dataset-1.0.3
    chapman: /workspace/data/chapman/a-large-scale-12-lead-electrocardiogram-database-for-arrhythmia-study-1.0.0
    manifest_path: /workspace/Cross-Dataset-Generalization-in-ECG-via-Invariant-Representation-Learning/data/processed/master_manifest.csv
    processed_path: /workspace/Cross-Dataset-Generalization-in-ECG-via-Invariant-Representation-Learning/data/processed/signals.h5
    split_path: /workspace/Cross-Dataset-Generalization-in-ECG-via-Invariant-Representation-Learning/data/processed/splits.json
  splits:
    train: 0.7
    val: 0.1
  seed: 42
  sampling_rate: 250
  shortcut:
    use_shortcut: false
    freq: 60
    prob: 1.0
    amplitude: 0.1
    correlation: 0.9
model:
  _target_: src.models.resnet1d.ResNet1d
  input_channels: 12
  num_classes: 7
  layers:
  - 2
  - 2
  - 2
  - 2
  planes:
  - 64
  - 128
  - 256
  - 512
method:
  name: irm
  num_domains: 2
  penalty_weight: 100.0
  annealing_epochs: 10
train:
  epochs: 50
  batch_size: 64
  lr: 0.001
  weight_decay: 0.0001
  optimizer: AdamW

[2026-01-05 17:01:34,267][__main__][INFO] - Loading Manifest and Splits...
[2026-01-05 17:01:34,268][__main__][INFO] - Loading Manifest and Splits...
[2026-01-05 17:01:34,565][__main__][INFO] - Train Size: 46867, Val Size: 6695
[2026-01-05 17:01:34,618][__main__][INFO] - Filtering for sources: ['ptbxl', 'chapman']
[2026-01-05 17:01:34,628][__main__][INFO] - Filtered Train Size: 46867, Val Size: 6695
[2026-01-05 17:02:01,375][__main__][INFO] - Instantiating Model...
[2026-01-05 17:10:29,166][__main__][INFO] - Training Config: 
seed: 42
debug: false
data:
  paths:
    ptbxl: /workspace/data/ptbxl/ptb-xl-a-large-publicly-available-electrocardiography-dataset-1.0.3
    chapman: /workspace/data/chapman/a-large-scale-12-lead-electrocardiogram-database-for-arrhythmia-study-1.0.0
    manifest_path: /workspace/Cross-Dataset-Generalization-in-ECG-via-Invariant-Representation-Learning/data/processed/master_manifest.csv
    processed_path: /workspace/Cross-Dataset-Generalization-in-ECG-via-Invariant-Representation-Learning/data/processed/signals.h5
    split_path: /workspace/Cross-Dataset-Generalization-in-ECG-via-Invariant-Representation-Learning/data/processed/splits.json
  splits:
    train: 0.7
    val: 0.1
  seed: 42
  sampling_rate: 250
  shortcut:
    use_shortcut: false
    freq: 60
    prob: 1.0
    amplitude: 0.1
    correlation: 0.9
model:
  _target_: src.models.resnet1d.ResNet1d
  input_channels: 12
  num_classes: 7
  layers:
  - 2
  - 2
  - 2
  - 2
  planes:
  - 64
  - 128
  - 256
  - 512
method:
  _target_: src.methods.irm.IRM
train:
  epochs: 50
  batch_size: 64
  lr: 0.001
  weight_decay: 0.0001
  optimizer: AdamW

[2026-01-05 17:10:29,270][__main__][INFO] - Loading Manifest and Splits...
[2026-01-05 17:10:29,271][__main__][INFO] - Loading Manifest and Splits...
[2026-01-05 17:10:29,544][__main__][INFO] - Train Size: 46867, Val Size: 6695
[2026-01-05 17:10:29,598][__main__][INFO] - Filtering for sources: ['ptbxl', 'chapman']
[2026-01-05 17:10:29,607][__main__][INFO] - Filtered Train Size: 46867, Val Size: 6695
[2026-01-05 17:10:50,863][__main__][INFO] - Instantiating Model...
[2026-01-05 17:10:51,043][__main__][INFO] - Instantiating Method: src.methods.irm.IRM
[2026-01-05 17:20:41,113][__main__][INFO] - Epoch 1: Train Loss: 3.1180, Train Acc: 0.0850 | Val Loss: 1.8387, Val Acc: 0.0744, Val F1: 0.0500
[2026-01-05 17:20:41,487][__main__][INFO] - New Best Model Saved!
[2026-01-05 17:27:38,543][__main__][INFO] - Epoch 2: Train Loss: 1.9391, Train Acc: 0.0950 | Val Loss: 1.8478, Val Acc: 0.0267, Val F1: 0.0275
[2026-01-05 17:30:18,004][__main__][INFO] - Epoch 3: Train Loss: 1.9027, Train Acc: 0.0505 | Val Loss: 1.8032, Val Acc: 0.2100, Val F1: 0.0925
[2026-01-05 17:30:18,231][__main__][INFO] - New Best Model Saved!
[2026-01-05 17:32:56,655][__main__][INFO] - Epoch 4: Train Loss: 1.9090, Train Acc: 0.0908 | Val Loss: 1.8028, Val Acc: 0.1425, Val F1: 0.1041
[2026-01-05 17:32:56,925][__main__][INFO] - New Best Model Saved!
[2026-01-05 17:35:35,123][__main__][INFO] - Epoch 5: Train Loss: 1.9002, Train Acc: 0.0669 | Val Loss: 1.7749, Val Acc: 0.2290, Val F1: 0.0618
[2026-01-05 17:38:14,002][__main__][INFO] - Epoch 6: Train Loss: 2.0698, Train Acc: 0.1327 | Val Loss: 1.8595, Val Acc: 0.1023, Val F1: 0.0343
[2026-01-05 17:40:53,557][__main__][INFO] - Epoch 7: Train Loss: 1.8871, Train Acc: 0.0958 | Val Loss: 1.8157, Val Acc: 0.0547, Val F1: 0.0263
[2026-01-05 17:43:32,659][__main__][INFO] - Epoch 8: Train Loss: 1.8716, Train Acc: 0.0884 | Val Loss: 1.8076, Val Acc: 0.0908, Val F1: 0.0400
[2026-01-05 17:46:13,022][__main__][INFO] - Epoch 9: Train Loss: 1.8834, Train Acc: 0.0887 | Val Loss: 1.8207, Val Acc: 0.0768, Val F1: 0.0572
[2026-01-05 17:48:52,122][__main__][INFO] - Epoch 10: Train Loss: 1.8972, Train Acc: 0.0970 | Val Loss: 1.8244, Val Acc: 0.0836, Val F1: 0.0522
[2026-01-05 17:51:33,259][__main__][INFO] - Epoch 11: Train Loss: 1.8604, Train Acc: 0.0741 | Val Loss: 1.8163, Val Acc: 0.0433, Val F1: 0.0371
[2026-01-05 17:54:14,601][__main__][INFO] - Epoch 12: Train Loss: 1.8540, Train Acc: 0.0687 | Val Loss: 1.7985, Val Acc: 0.0551, Val F1: 0.0526
[2026-01-05 17:56:56,659][__main__][INFO] - Epoch 13: Train Loss: 1.8791, Train Acc: 0.0771 | Val Loss: 1.8063, Val Acc: 0.0503, Val F1: 0.0395
[2026-01-05 17:59:37,410][__main__][INFO] - Epoch 14: Train Loss: 1.8603, Train Acc: 0.0760 | Val Loss: 1.8223, Val Acc: 0.0580, Val F1: 0.0627
[2026-01-05 18:02:24,755][__main__][INFO] - Epoch 15: Train Loss: 1.8501, Train Acc: 0.0646 | Val Loss: 1.8058, Val Acc: 0.0515, Val F1: 0.0536
[2026-01-05 18:05:05,658][__main__][INFO] - Epoch 16: Train Loss: 1.8696, Train Acc: 0.0679 | Val Loss: 1.8311, Val Acc: 0.0672, Val F1: 0.0413
[2026-01-05 18:07:46,463][__main__][INFO] - Epoch 17: Train Loss: 1.8509, Train Acc: 0.0695 | Val Loss: 1.8238, Val Acc: 0.0600, Val F1: 0.0346
[2026-01-05 18:10:27,064][__main__][INFO] - Epoch 18: Train Loss: 1.8464, Train Acc: 0.0645 | Val Loss: 1.8056, Val Acc: 0.0877, Val F1: 0.0510
[2026-01-05 18:13:08,024][__main__][INFO] - Epoch 19: Train Loss: 1.8410, Train Acc: 0.0707 | Val Loss: 1.7844, Val Acc: 0.0780, Val F1: 0.0647
[2026-01-05 18:15:48,724][__main__][INFO] - Epoch 20: Train Loss: 1.8320, Train Acc: 0.0881 | Val Loss: 1.7937, Val Acc: 0.0754, Val F1: 0.0799
[2026-01-05 18:18:31,269][__main__][INFO] - Epoch 21: Train Loss: 1.8010, Train Acc: 0.0685 | Val Loss: 1.7257, Val Acc: 0.0614, Val F1: 0.0454
[2026-01-05 18:21:11,261][__main__][INFO] - Epoch 22: Train Loss: 1.7716, Train Acc: 0.0847 | Val Loss: 1.7616, Val Acc: 0.0594, Val F1: 0.0385
[2026-01-05 18:23:57,721][__main__][INFO] - Epoch 23: Train Loss: 1.7128, Train Acc: 0.0695 | Val Loss: 1.6568, Val Acc: 0.0621, Val F1: 0.0471
[2026-01-05 18:26:42,758][__main__][INFO] - Epoch 24: Train Loss: 1.6715, Train Acc: 0.0524 | Val Loss: 1.6022, Val Acc: 0.1165, Val F1: 0.1049
[2026-01-05 18:26:42,994][__main__][INFO] - New Best Model Saved!
[2026-01-05 18:29:23,314][__main__][INFO] - Epoch 25: Train Loss: 1.6340, Train Acc: 0.0963 | Val Loss: 1.5754, Val Acc: 0.1004, Val F1: 0.0732
[2026-01-05 18:32:03,360][__main__][INFO] - Epoch 26: Train Loss: 1.6092, Train Acc: 0.0979 | Val Loss: 1.5527, Val Acc: 0.1192, Val F1: 0.1057
[2026-01-05 18:32:03,571][__main__][INFO] - New Best Model Saved!
[2026-01-05 18:34:43,256][__main__][INFO] - Epoch 27: Train Loss: 1.5961, Train Acc: 0.0974 | Val Loss: 1.5451, Val Acc: 0.1037, Val F1: 0.0935
[2026-01-05 18:37:22,916][__main__][INFO] - Epoch 28: Train Loss: 1.5868, Train Acc: 0.1049 | Val Loss: 1.5080, Val Acc: 0.1029, Val F1: 0.1206
[2026-01-05 18:37:23,119][__main__][INFO] - New Best Model Saved!
[2026-01-05 18:40:06,722][__main__][INFO] - Epoch 29: Train Loss: 1.5668, Train Acc: 0.1010 | Val Loss: 1.5176, Val Acc: 0.0925, Val F1: 0.0348
[2026-01-05 18:42:50,124][__main__][INFO] - Epoch 30: Train Loss: 1.5533, Train Acc: 0.0894 | Val Loss: 1.5204, Val Acc: 0.0856, Val F1: 0.0626
[2026-01-05 18:45:30,559][__main__][INFO] - Epoch 31: Train Loss: 1.5419, Train Acc: 0.0892 | Val Loss: 1.4570, Val Acc: 0.0769, Val F1: 0.1210
[2026-01-05 18:45:30,830][__main__][INFO] - New Best Model Saved!
[2026-01-05 18:48:13,017][__main__][INFO] - Epoch 32: Train Loss: 1.5141, Train Acc: 0.0814 | Val Loss: 1.4663, Val Acc: 0.0783, Val F1: 0.0507
[2026-01-05 18:50:58,062][__main__][INFO] - Epoch 33: Train Loss: 1.4799, Train Acc: 0.0656 | Val Loss: 1.4359, Val Acc: 0.0736, Val F1: 0.1043
[2026-01-05 18:53:38,415][__main__][INFO] - Epoch 34: Train Loss: 1.4855, Train Acc: 0.0681 | Val Loss: 1.4378, Val Acc: 0.0415, Val F1: 0.0742
[2026-01-05 18:56:17,318][__main__][INFO] - Epoch 35: Train Loss: 1.4530, Train Acc: 0.0784 | Val Loss: 1.4118, Val Acc: 0.1670, Val F1: 0.1574
[2026-01-05 18:56:17,489][__main__][INFO] - New Best Model Saved!
[2026-01-05 18:58:57,260][__main__][INFO] - Epoch 36: Train Loss: 1.4648, Train Acc: 0.0838 | Val Loss: 1.4043, Val Acc: 0.1040, Val F1: 0.0860
[2026-01-05 19:01:41,263][__main__][INFO] - Epoch 37: Train Loss: 1.4231, Train Acc: 0.0947 | Val Loss: 1.4061, Val Acc: 0.0859, Val F1: 0.1068
[2026-01-05 19:04:22,157][__main__][INFO] - Epoch 38: Train Loss: 1.4119, Train Acc: 0.1138 | Val Loss: 1.3720, Val Acc: 0.0937, Val F1: 0.1380
[2026-01-05 19:07:03,561][__main__][INFO] - Epoch 39: Train Loss: 1.4278, Train Acc: 0.1249 | Val Loss: 1.3916, Val Acc: 0.0860, Val F1: 0.0548
[2026-01-05 19:09:46,413][__main__][INFO] - Epoch 40: Train Loss: 1.4470, Train Acc: 0.0926 | Val Loss: 1.3540, Val Acc: 0.1440, Val F1: 0.1109
[2026-01-05 19:12:29,961][__main__][INFO] - Epoch 41: Train Loss: 1.3978, Train Acc: 0.1422 | Val Loss: 1.3823, Val Acc: 0.0948, Val F1: 0.1412
[2026-01-05 19:15:16,036][__main__][INFO] - Epoch 42: Train Loss: 1.3930, Train Acc: 0.1279 | Val Loss: 1.3686, Val Acc: 0.1147, Val F1: 0.1192
[2026-01-05 19:17:57,074][__main__][INFO] - Epoch 43: Train Loss: 1.3697, Train Acc: 0.1413 | Val Loss: 1.3509, Val Acc: 0.1504, Val F1: 0.1334
[2026-01-05 19:20:37,724][__main__][INFO] - Epoch 44: Train Loss: 1.3670, Train Acc: 0.1876 | Val Loss: 1.2985, Val Acc: 0.1665, Val F1: 0.1746
[2026-01-05 19:20:37,881][__main__][INFO] - New Best Model Saved!
[2026-01-05 19:23:18,657][__main__][INFO] - Epoch 45: Train Loss: 1.3671, Train Acc: 0.2017 | Val Loss: 1.3052, Val Acc: 0.1643, Val F1: 0.1811
[2026-01-05 19:23:18,857][__main__][INFO] - New Best Model Saved!
[2026-01-05 19:25:58,626][__main__][INFO] - Epoch 46: Train Loss: 1.3468, Train Acc: 0.2021 | Val Loss: 1.3134, Val Acc: 0.2336, Val F1: 0.1935
[2026-01-05 19:25:58,948][__main__][INFO] - New Best Model Saved!
[2026-01-05 19:28:38,557][__main__][INFO] - Epoch 47: Train Loss: 1.3310, Train Acc: 0.2160 | Val Loss: 1.2749, Val Acc: 0.1673, Val F1: 0.2303
[2026-01-05 19:28:38,793][__main__][INFO] - New Best Model Saved!
[2026-01-05 19:31:19,162][__main__][INFO] - Epoch 48: Train Loss: 1.3422, Train Acc: 0.2121 | Val Loss: 1.2765, Val Acc: 0.2439, Val F1: 0.2294
[2026-01-05 19:33:58,718][__main__][INFO] - Epoch 49: Train Loss: 1.3214, Train Acc: 0.2236 | Val Loss: 1.2252, Val Acc: 0.1754, Val F1: 0.2054
[2026-01-05 19:36:37,417][__main__][INFO] - Epoch 50: Train Loss: 1.3147, Train Acc: 0.2314 | Val Loss: 1.2390, Val Acc: 0.2420, Val F1: 0.2506
[2026-01-05 19:36:37,610][__main__][INFO] - New Best Model Saved!
